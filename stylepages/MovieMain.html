<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <link href="../css/layout.css" rel="stylesheet" type="text/css" media="screen"/>
    <title>MovieMain</title>
<style>
table,th,td {
  border : 1px solid black;
  border-collapse: collapse;
}
th,td {
  padding: 5px;
}
</style>
</head>
<body>

	 <p>Frage per HTTP-GET einen Rest-Service: </p>
        <p id="myMovie"> </p>
        
        <button type="button" onclick="loadDoc()">Meine Filme anzeigen</button>
        
        <p>Detailliert Filminformationen</p>
		<p id='showMovie'></p>
		
		<p id="demo"></p>
       
        <script>
            function loadDoc() {
            	
            	var myObj, x;
            	var txt = "";
                var xhttp = new XMLHttpRequest();
                
                xhttp.onreadystatechange = function () {
                    if (this.readyState == 4 && this.status == 200) 
                    	
                    	myObj = JSON.parse(this.responseText);
                    	txt += "<table border='1'>";
                    	                    	
                    	for (x in myObj) {
                            txt += "<tr><td>" + myObj[x].titel + "</td><td><button type='button' onclick='detailMovie("+x+")'>Details</button> </td></tr>";
                            //wert immer so uebergeben: + x +
                        }
                        txt += "</table>";        
                        document.getElementById("myMovie").innerHTML = txt;        
                                            	
                }; 
                                                                 
                xhttp.open("GET", "../json/movielist.json", true);
                //nochmal open macht nur letzte list auf "addliste.json", 
                xhttp.send();
            }
            
        </script>
        
        <script>
        function detailMovie(x){
        	var myObj;
        	var i = x;
        	var txt = "";
        	var xhttp = new XMLHttpRequest();
            
            xhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200)
                	
                	myObj = JSON.parse(this.responseText);                  	
                    txt = "Titel: "+ myObj[i].titel + "<br> Regisseur: " + myObj[i].regie + "<br> Erscheinungsjahr: " 
                    + myObj[i].jahr+ "<br> Genre: " + myObj[i].genre+ "<br> Schauspieler: " + myObj[i].schauspieler;
               		document.getElementById("showMovie").innerHTML = txt;
           		};
           xhttp.open("GET", "../json/movielist.json", true);
           xhttp.send();
        }
        </script>
        
                        
</body>
</html>